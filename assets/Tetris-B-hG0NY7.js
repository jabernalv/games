import{I as se,r,o as re,n as ue,Q as ce,c as Q,e as l,j as ie,t as w,d as q}from"./vue-vendor-DpVgmi3Y.js";import{_ as fe}from"./index-DTi9Hzvm.js";import"./primevue-B_xtssf4.js";const ve={class:"min-h-screen min-w-screen fixed inset-0 z-0 bg-gradient-to-br from-[#c0c0c0] via-[#e0e0e0] to-[#c0c0c0] flex items-center justify-center"},de={class:"game-container relative z-10"},he={class:"game-header"},pe={class:"game-info"},me={class:"game-area"},ge={class:"main-board"},ye={class:"side-panel"},_e={class:"next-piece"},be={key:0,class:"game-over"},ke={class:"game-over-content"},y=10,x=20,a=30,we=se({__name:"Tetris",setup(xe){const R=y*a,T=x*a,d=r(0),h=r(1),S=r(0),c=r(!1),i=r(!1),f=r([]),n=r(null),p=r(null),C=r(1e3);let m=null;const g=r(0),M=r(null),j=r(null),D={I:{shape:[[1,1,1,1]],color:"#00f5ff"},O:{shape:[[1,1],[1,1]],color:"#ffff00"},T:{shape:[[0,1,0],[1,1,1]],color:"#800080"},S:{shape:[[0,1,1],[1,1,0]],color:"#00ff00"},Z:{shape:[[1,1,0],[0,1,1]],color:"#ff0000"},J:{shape:[[1,0,0],[1,1,1]],color:"#0000ff"},L:{shape:[[0,0,1],[1,1,1]],color:"#ffa500"}},O=Object.keys(D);function B(){const e=O[Math.floor(Math.random()*O.length)],t=D[e];return{shape:t.shape.map(o=>[...o]),color:t.color,x:Math.floor(y/2)-Math.floor(t.shape[0].length/2),y:0,type:e}}function F(){f.value=Array.from({length:x},()=>Array(y).fill(0))}function _(){const e=M.value?.getContext("2d");if(e){e.clearRect(0,0,R,T),e.fillStyle="#222",e.fillRect(0,0,R,T);for(let t=0;t<x;t++)for(let o=0;o<y;o++)f.value[t][o]&&(e.fillStyle=f.value[t][o],e.fillRect(o*a,t*a,a,a),e.strokeStyle="#444",e.strokeRect(o*a,t*a,a,a));n.value&&$(e,n.value)}}function $(e,t){for(let o=0;o<t.shape.length;o++)for(let s=0;s<t.shape[o].length;s++)t.shape[o][s]&&(e.fillStyle=t.color,e.fillRect((t.x+s)*a,(t.y+o)*a,a,a),e.strokeStyle="#444",e.strokeRect((t.x+s)*a,(t.y+o)*a,a,a))}function E(){const e=j.value?.getContext("2d");if(!e||(e.clearRect(0,0,80,80),!p.value))return;const t=p.value.shape,o=Math.floor((4-t[0].length)/2),s=Math.floor((4-t.length)/2);for(let u=0;u<t.length;u++)for(let v=0;v<t[u].length;v++)t[u][v]&&(e.fillStyle=p.value.color,e.fillRect((v+o)*16,(u+s)*16,16,16),e.strokeStyle="#444",e.strokeRect((v+o)*16,(u+s)*16,16,16))}function b(e,t=0,o=0,s=null){const u=s||e.shape,v=e.x+t,ae=e.y+o;for(let k=0;k<u.length;k++)for(let P=0;P<u[k].length;P++)if(u[k][P]){const L=v+P,A=ae+k;if(L<0||L>=y||A>=x||A>=0&&f.value[A][L])return!0}return!1}function ee(){for(let e=0;e<n.value.shape.length;e++)for(let t=0;t<n.value.shape[e].length;t++)if(n.value.shape[e][t]){const o=n.value.x+t,s=n.value.y+e;s>=0&&(f.value[s][o]=n.value.color)}}function te(){let e=0;for(let t=x-1;t>=0;t--)f.value[t].every(o=>o)&&(f.value.splice(t,1),f.value.unshift(Array(y).fill(0)),e++,t++);e>0&&(d.value+=[0,40,100,300,1200][e]*h.value,S.value+=e,S.value>=h.value*10&&(h.value++,C.value=Math.max(100,1e3-(h.value-1)*50)),K())}function Y(){n.value=p.value||B(),p.value=B(),b(n.value)&&(c.value=!0,W())}function I(e,t){!n.value||c.value||i.value||b(n.value,e,t)||(n.value.x+=e,n.value.y+=t,_())}function G(){I(-1,0)}function H(){I(1,0)}function N(){I(0,1)}function X(){if(!n.value||c.value||i.value)return;const e=n.value.shape[0].map((t,o)=>n.value.shape.map(s=>s[o])).reverse();b(n.value,0,0,e)||(n.value.shape=e,_())}function z(){if(!(!n.value||c.value||i.value)){for(;!b(n.value,0,1);)n.value.y++;J()}}function J(){!n.value||c.value||i.value||(b(n.value,0,1)?(ee(),te(),Y()):n.value.y++,_(),E())}function U(){c.value||i.value||(J(),m=window.setTimeout(U,C.value))}function V(){d.value=0,h.value=1,S.value=0,C.value=1e3,c.value=!1,i.value=!1,F(),p.value=B(),Y(),_(),E(),m&&clearTimeout(m),m=window.setTimeout(U,C.value),K()}function W(){m&&clearTimeout(m)}function le(){V()}function Z(e){c.value||(e.key==="ArrowLeft"?G():e.key==="ArrowRight"?H():e.key==="ArrowDown"?N():e.key==="ArrowUp"?X():e.key===" "?z():e.key.toLowerCase()==="p"&&(i.value=!i.value))}const oe=()=>{const e=localStorage.getItem("tetris_best_score");if(e)try{g.value=parseInt(e)}catch{g.value=0}},ne=()=>{localStorage.setItem("tetris_best_score",String(g.value))};function K(){d.value>g.value&&(g.value=d.value,ne())}return re(()=>{ue(()=>{oe(),V(),window.addEventListener("keydown",Z),_(),E()})}),ce(()=>{W(),window.removeEventListener("keydown",Z)}),(e,t)=>(q(),Q("div",ve,[l("div",de,[l("div",he,[t[0]||(t[0]=l("h1",null,"Tetris",-1)),l("div",pe,[l("span",null,"Puntaje: "+w(d.value),1),l("span",null,"Récord: "+w(g.value),1),l("span",null,"Nivel: "+w(h.value),1),l("span",null,"Líneas: "+w(S.value),1)])]),l("div",me,[l("div",ge,[l("canvas",{ref_key:"gameBoard",ref:M,width:R,height:T},null,512)]),l("div",ye,[l("div",_e,[t[1]||(t[1]=l("h3",null,"Siguiente",-1)),l("canvas",{ref_key:"nextPieceCanvas",ref:j,width:"80",height:"80"},null,512)]),l("div",{class:"controls"},[t[2]||(t[2]=l("h3",null,"Controles",-1)),l("div",{class:"control-buttons"},[l("button",{class:"control-btn rotate-btn",onClick:X},"⟳"),l("button",{class:"control-btn left-btn",onClick:G},"←"),l("button",{class:"control-btn down-btn",onClick:N},"↓"),l("button",{class:"control-btn right-btn",onClick:H},"→"),l("button",{class:"control-btn drop-btn",onClick:z},"⤓")]),t[3]||(t[3]=l("div",{class:"keyboard-controls"},[l("h4",null,"Teclado"),l("p",null,"← → : Mover"),l("p",null,"↑ : Rotar"),l("p",null,"↓ : Bajar"),l("p",null,"Espacio: Caída rápida"),l("p",null,"P : Pausa")],-1))])])]),c.value?(q(),Q("div",be,[l("div",ke,[t[4]||(t[4]=l("h2",null,"¡Game Over!",-1)),l("p",null,"Puntaje: "+w(d.value),1),l("button",{onClick:le},"Jugar de nuevo")])])):ie("",!0)])]))}}),Re=fe(we,[["__scopeId","data-v-1e1be3a9"]]);export{Re as default};
